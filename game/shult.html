<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-cmn-Hans-CN">
<head>
<meta charset="utf-8">
<title>舒尔特方格 - hi游戏</title>
<meta name="description" content="hi游戏，缓解你的压力！" />
<meta name="keywords" content="hi,游戏,舒尔特,方格,shult,舒尔特方格,娱乐,解压" />
<meta name="copyright" content="3429442539@qq.com" />
<meta http-equiv="Server" content="Hi" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta http-equiv="refresh" content="86400" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="expires" content="-1">
<link rel="shortcut icon" href="/i/favicon.ico" sizes="32x32"/>
<link rel="stylesheet" href="/css/nocopy.css" type="text/css" />
<script src="/js/antidebugger.js"></script>
<script type="text/javascript" src="/js/jquery.min.js"></script>
<!--wx,qq干游戏，所以写遮罩，1，引入脚本和css（用了jq），好注释放这引入，head引入保险-->
<script src="/js/wechatqq.js"></script>
<link rel="stylesheet" href="/css/wechatqq.css" type="text/css" />
<meta name="renderer" content="webkit">
<link href="/fonts/shult/clear-sans.css" rel="stylesheet" as="style" onload="this.onload=null;this.rel='stylesheet'">
<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<style type="text/css">

		* {
			margin: 0;
		}

		#main {
			--cell-size: 106.25px;
			--cell-space: 15px;
			--size: 3;
		}

		body {
			background-color: #faf8ef;
			color: #776e65;
			font-family: "Clear Sans", "Helvetica Neue", Arial, sans-serif;
		}


		#main {
			margin: 0 auto;
			margin-top: 30px;
 			display: grid;
 			width: calc(var(--size) * var(--cell-size) + (var(--size) + 1) * var(--cell-space));
 			height: calc(var(--size) * var(--cell-size) + (var(--size) + 1) * var(--cell-space));
		}
		#box {
			margin-top: 10px;
			background-color: #bbada0;
			border-radius: 6px;
		}
		.row {
			margin: var(--cell-space) var(--cell-space);
 			display: inline-block;
 			width: calc(var(--size) * var(--cell-size) + (var(--size) - 1) * var(--cell-space));
		}
		.cell {
			border-radius: 3px;
			float: left;
			width: var(--cell-size);
			height: var(--cell-size);
			background-color: rgb(238 228 218 / 35%);
		}
		.cell.current {
			background-color: #edd073;
		}
		.cell:not(:last-child) {
			margin-right: var(--cell-space);
		}
		
		.row:not(:last-child) {
			margin-bottom: 0;
		}

		.num {
			font-size: 55px;
			font-weight: bold;
			text-align: center;
			width: var(--cell-size);
			height: var(--cell-size);
			line-height: var(--cell-size);
			color: #f9f6f2;
		}
		.title {
		    font-size: 50px;
		    font-weight: bold;
		    margin: 0;
		    display: block;
		    float: left;
		}
		.score {
			float: right;
		}
		#current-time,
		#best-time {
		    float: left;
			position: relative;
			display: block;
			padding: 15px 25px;
			background: #bbada0;
			border-radius: 3px;
			color: white;
			font-size: 25px;
			height: 25px;
		    line-height: 47px;
		    font-weight: bold;
		}
		#best-time {
			margin-left: 6px;
		}
		#current-time:after,
		#best-time:after {
			position: absolute;
			left: 0;
			top: 10px;
			width: 100%;
			font-size: 13px;
		    line-height: 13px;
		    text-align: center;
		    color: #eee4da;
		    text-transform: uppercase;
		}
		#current-time:after {
			content: "Time";
		}
		#best-time:after {
			content: "Best";
		}
		.fly {
			display: none;
			position: absolute;

		}
		.top {
			position: relative;
		}

		.center {
			position: absolute;
			right: -70px;
			bottom: -210px;
		}
		.center>div {
			font-weight: bold;
			text-align: center;
			line-height: 30px;
			width: 50px;
			height: 30px;
			background-color: #bbada0;
			border-radius: 3px;
			margin: 10px 10px;
			color: #f9f6f2;
		}

		@media screen and (max-width: 520px) {
			#main {
				--cell-size: 57.5px;
				--cell-space: 10px;
				--size: 3;
			}
			.num {
				font-size: 35px;
			｝
		}
	</style>
	<script type="text/javascript">
		const BEST_TIME_KEY = "schult.best.time";
		let size = 5;
		const random = [];
		let current = 1;
		let allCells = [];
		let start = 0;
		let bestTime = JSON.parse(localStorage.getItem(BEST_TIME_KEY) || "{}");
		let bestTimeNode = null;

		function addRow(main, rowNum) {
			const row = document.createElement("div");
			row.className = "row";
			main.appendChild(row);
			const cells = [];
			for(let i = 0; i < size; i++) {
				const cell = addCell(row, rowNum, i);
				cells.push(cell);
			}
			return cells;
		}
		function addCell(row, rowNum, cellNum) {
			const cell = document.createElement("div");
			const num = document.createElement("div");
			cell.className = "cell";
			num.className = "num";
			const currentNum = random[rowNum * size + cellNum];
			num.innerHTML = currentNum;
			cell.appendChild(num);
			row.appendChild(cell);

			cell.addEventListener("click", () => {
				if (currentNum == current) {
					for(let c of allCells) {
						c.classList.remove("current");
					}
					cell.classList.add("current");
					current++;

					if (currentNum == 1) {
						start = Date.now();
						const time = document.getElementById("time");
						gameInterval = setInterval(() => {
							const cost = Math.floor(((Date.now() - start) / 10)) / 100;
							time.innerHTML = formatCost(cost);
						}, 10);
					} else if (currentNum == size * size) {
						clearInterval(gameInterval);
						const cost = Math.floor(((Date.now() - start) / 10)) / 100;
						time.innerHTML = formatCost(cost);
						const currentBest = bestTime[size] || 0;
						if (currentBest == 0 || cost < currentBest) {
							bestTime[size] = cost;
							localStorage.setItem(BEST_TIME_KEY, JSON.stringify(bestTime));
							bestTimeNode.innerHTML = cost;
						}
					}
				}
			});
			return cell;
		}
		function formatCost(cost) {
			let str = cost.toString();
			let index = str.indexOf(".");
			if(index == -1) {
				return str + ".00";
			} else if (index == str.length - 2) {
				return str + "0";
			}
			return str;
		}
		let gameInterval = -1;

		function setHard(hard) {
            if (hard == 3) {
                $(".footer").hide(1000);
            } else {
                $(".footer").show(1000);
            };
			if (gameInterval > 0) {
				clearInterval(gameInterval);
			}
			size = hard;

			bestTimeNode.innerHTML = bestTime[size] || 0;

			random.length = 0;
			current = 1;
			for(let i = 0; i < size; i++) {
				for(let j = 0; j < size; j++) {
					random.push(i * size + j + 1);
				}
			}
			for(let i = random.length - 1; i >= 0; i--) {
				let r = Math.floor(Math.random() * i);
				let temp = random[i];
				random[i] = random[r];
				random[r] = temp;
			}
			console.log(random);

			const main = document.getElementById("main");
			const box = document.getElementById("box");
			for(let i = box.children.length - 1; i >= 0; i--) {
				const child = box.children[i];
				box.removeChild(child);
			}
			let rows = [];
			for(let i = 0; i < size; i++) {
				let row = addRow(box, i);
				rows.push(...row);
			}
			allCells = rows;
			console.log(allCells);

			main.style.setProperty("--size", size);
		}

		window.onload = () => {
			bestTimeNode = document.getElementById("best-time");
			setHard(4);
		}

	</script>
</head>
<!-- ondragstart:防拖拽生成新页面-->
<body ondragstart='return false' oncontextmenu='self.event.returnValue=false' id="body">
<!--2.遮罩实现（div里面的就是遮罩内容）-->
<div class="weixin-tip">
<p>
<img src="/i/wechat.png" alt="请点击右上角三个点，选择在浏览器打开"/>
</p>
<br />
<p>
<font color="red" size="30"><b><u><mark>或者长按复制链接到浏览器打开&nbsp;<a href="/game/shult.html">https://wangzi-kai.github.io/game/shult.html</a></mark></u></b></font>
</p>
<p>
<mark>如果您使用的是QQ浏览器，请您临时将UA切换到电脑，对界面大小无影响</mark>
</p>
</div>
<noscript><div align="center"><font size="50" color="red">本游戏为css+JavaScript+H5游戏，检测到你的浏览器不支持JavaScript，请检查是否被禁用或者更换浏览器</font></div><br /><br /></noscript>
	<div id="main">
		<div class="top">
			<h1 class="title">舒尔特方格</h1>
			<div class="score">
				<div id="current-time">
					<span id="time">0</span>
					<span class="fly">0</span>
				</div>
				<div id="best-time">4</div>
			</div>

			<div class="center">
				<div onclick="setHard(3)">3X3</div>
				<div onclick="setHard(4)">4X4</div>
				<div onclick="setHard(5)">5X5</div>
				<div onclick="setHard(6)">6X6</div>
				<div onclick="setHard(7)">7X7</div>
			</div>
		</div>
		<div id="box">
			<div class="row">
				<div class="cell"></div>
				<div class="cell"></div>
				<div class="cell"></div>
			</div>
			<div class="row">
				<div class="cell"></div>
				<div class="cell"></div>
				<div class="cell"></div>
			</div>
			<div class="row">
				<div class="cell"></div>
				<div class="cell"></div>
				<div class="cell"></div>
			</div>
		</div>
	</div>
<footer id="footer">
<br />
<br />
<br /><br /><br /><br /><br /><br /><br /><br />
<p><div align="center"><font size="20"><a href="/game/" title="点击这里返回首页">点击这里返回首页</a></font></div></p>
<div id="cc-myssl-id" style="position: fixed;right: 0;bottom: 0;width: 65px;height: 65px;z-index: 99;">
<a href="https://myssl.com/seal/detail?domain=wangzi-kai.github.io"><img src="/i/myssl-id.png" alt="https安全认证" title="点击查看本站https安全性" border="0" style="width:100%;height:100%"></a>
</div>
<div align="center"><script type="text/javascript" src="/js/cnzz.js"></script><noscript><a href="https://www.cnzz.com/stat/website.php?web_id=1279498743"><img src="https://icon.cnzz.com/img/pic1.gif" border="0" /></noscript></div>
</footer>
</body>
</html>