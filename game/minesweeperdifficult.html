<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<html lang="zh-cmn-Hans-CN">
<html>
<head>
<meta charset="utf-8">
<title>扫雷（中等） - hi游戏</title>
<meta name="description" content="hi游戏，缓解你的的压力！" />
<meta name="keywords" content="hi,游戏,扫雷,娱乐,解压,分级" />
<meta name="copyright" content="3429442539@qq.com" />
<meta http-equiv="Server" content="Hi" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta http-equiv="refresh" content="86400" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="expires" content="-1">
<style>
		*{
			padding:0px;
			margin:0px;
		}
		.container{
			width:6000px;
			height:6000px;
			border:1px solid #f00;
			margin:0 auto;
		}
		.container .block{
			width:60px;
			height:60px;
			background-color: #abcdef;
			float:left;
			border:1px solid red;
			box-sizing:border-box;
			cursor: pointer;
		}
		.container .lei{
			/*background: url('dl.jpg') no-repeat center center/ 100% 100%;*/
		}
		.container .show{
			background: url('dl.jpg') no-repeat center center/ 100% 100%;
		}
		.container .number{
			background-color: #fff;
			text-align: center;
			line-height: 60px;
		}
		.container .biaoji{
			background: url('qz.jpg') no-repeat center center/ 100% 100%;

		}
	</style>
</head>

<body>
<a href="/game/minesweeper.html">容易</a>&nbsp;&nbsp;<a href="/game/minesweepermiddle.html">中等</a>&nbsp;&nbsp;<a href="/game/minesweeperdifficult.html">困难</a>
<br />
<noscript><font size="50" color="red">本游戏为JavaScript+H5游戏，检测到你的浏览器不支持JavaScript，请检查是否被禁用或者更换浏览器</font><br /><br /></noscript>
<div class="container">
</div>
<footer>
<br />
<br />
<p><div align="center"><font size="20"><a href="/" title="点击这里进入官网">点击这里进入官网</a></font></div></p>
<div id="cc-myssl-id" style="position: fixed;right: 0;bottom: 0;width: 65px;height: 65px;z-index: 99;">
<a href="https://myssl.com/seal/detail?domain=wangzi-kai.github.io"><img src="/i/myssl-id.png" alt="https安全认证" title="点击查看本站https安全性" border="0" style="width:100%;height:100%"></a>
</div>
<div align="center"><script type="text/javascript" src="/js/script12.js"></script></div>
</footer>
</body>
<script>
	// 1、动态的创建表格

	let container = document.querySelector(".container");
	// 行数
	for(let i = 0 ;i< 80 ;i++){
		// 列数
		for(let j = 0;j<80;j++){

			// 创建div对象
			let divObj = document.createElement("div");

			// 添加类
			divObj.classList.add('block');
			divObj.id = "a"+i+"_"+j;
		
			// 将div对象追加到容器中
			container.appendChild(divObj);
		}
	}


	// 2、随机地雷
	let count = 100;
	// 获取所有盒子的个数
	let block = document.querySelectorAll(".block");
	do{
		// 随机地雷
		let random = Math.floor(Math.random()*block.length);
		block[random].classList.add("lei");
	}while(document.querySelectorAll(".lei").length<count);

	// 3、给小方块绑定事件
	block.forEach(function(item){
		// 鼠标点击
		item.onclick=function(){
			leftClick(item);
		}

		// 鼠标右键标记
		item.oncontextmenu = function(e){
			// 阻止浏览器的默认事件
			e.preventDefault();
			rightClick(item);
		}
	});

	// 右键点击方法

	function rightClick(obj){
		// 判断是否可以标记旗子
		if (!obj.classList.contains("number")) {
			// 标记小旗子
			obj.classList.toggle("biaoji");
		};
		// 判断游戏结束
		let biaoji = document.querySelectorAll(".biaoji.lei");
		let biaoji2 = document.querySelectorAll(".biaoji");
		// 判断扫雷成功
		if (biaoji.length == count && biaoji2.length == count) {
			alert("通过成功");
		};
	}
	// 左键点击方法

	function leftClick(obj){
		// 如果标记了小旗子

		if (obj.classList.contains("biaoji")) {
			return "";
		};
		// 判断所点击的表格是否是地雷
		// 如果是地雷，爆炸所有的地雷
		if (obj.classList.contains("lei")) {

			alert("游戏结束");

			// 获取所有的地雷

			let lei = document.querySelectorAll(".lei");

			// 显示所有的地雷

			lei.forEach(function(item){
				item.classList.add("show");
			});
			return "";
		};

		// 点击显示数字
		obj.classList.add("number");
		// 如何计算地雷的个数
		// 获取当前点击盒子的ID
			let ids = obj.id;
			let arr = ids.split("_");
		// 获取行号和列号
			let x = Number(arr[0].substr(1));
			let y = Number(arr[1]);
		// 计算附近地雷数
		let num=0;
		for(let i = x-1;i<=x+1;i++){
			for(let j = y-1;j<=y+1;j++){
				// 获取附近的对象
				let objs = document.querySelector(`#a${i}_${j}`);
				// 如果有地雷，数值增加
				if (objs && objs.classList.contains("lei")) {
					num++;
				};
			}
		}

		// 判断如果雷的个数0
		if (num) {
			obj.innerHTML = num;
		};
		// 如果是空白区域，扩散
		if (num == 0) {
			// 行
			for(let i = x-1;i <= x+1;i++){
				// 列
				for(let j = y-1;j <= y+1;j++){
					// 获取附近的对象
					let objs = document.querySelector(`#a${i}_${j}`);
					// 让小方块进行点击
					// 如果对象存在，并且未被点击的时候
					if (objs && !objs.classList.contains("number")) {
						leftClick(objs);
					};
				}
			}
		};
	}

</script>
</html>
